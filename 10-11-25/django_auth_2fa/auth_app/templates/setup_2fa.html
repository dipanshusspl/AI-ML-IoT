{% extends 'base.html' %}
{% block title %}Setup 2FA{% endblock %}
{% block content %}
<div class="card">
    <h2>Setup Two-Factor Authentication</h2>
    
    <div style="background: #e7f3ff; padding: 15px; border-radius: 4px; margin-bottom: 20px; border-left: 4px solid #007bff;">
        <strong>Step 1:</strong> Download an authenticator app:<br>
        • Google Authenticator<br>
        • Microsoft Authenticator<br>
        • Authy<br><br>
        <strong>Step 2:</strong> Scan the QR code below<br>
        <strong>Step 3:</strong> Enter the 6-digit code to verify
    </div>
    
    <p><strong>Scan this QR code with your authenticator app:</strong></p>
    <div style="text-align: center; margin: 20px 0; padding: 20px; background: #f8f9fa; border-radius: 4px;">
        <img src="data:image/png;base64,{{ qr_code }}" alt="QR Code" style="width: 250px; height: 250px;">
    </div>
    
    <p style="text-align: center; color: #666;">Can't scan? Enter this secret manually:</p>
    <div style="background: #f8f9fa; padding: 10px; border-radius: 4px; font-family: monospace; text-align: center; margin-bottom: 20px; word-break: break-all; font-size: 14px;">
        <strong>{{ secret }}</strong>
    </div>
    
    <hr style="margin: 20px 0;">
    
    <p><strong>Enter your 6-digit code:</strong></p>
    <form method="post">
        {% csrf_token %}
        <input type="text" name="token" placeholder="000000" maxlength="6" inputmode="numeric" autocomplete="off" required>
        <button type="submit">Verify & Enable 2FA</button>
    </form>
    
    {% if messages %}
    <div style="margin-top: 15px;">
        {% for message in messages %}
        <div style="padding: 10px; border-radius: 4px; {% if 'Invalid' in message %}background: #f8d7da; color: #721c24;{% else %}background: #d4edda; color: #155724;{% endif %}">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}
</div>
{% endblock %}
